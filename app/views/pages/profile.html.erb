<% content_for :title, "Profile" %>
    <div class="content" >
      <h1  class= "home-header">Profile</h1>
      <div class="nav-card_container" style="min-height: 80vh;">
        <div class="nav-index0" style="height: 45vh;">
     
<div class="image-wrapper" >  
   <% if current_user.header_image.attached? %>
        <%= image_tag current_user.header_image, class: "header-img" %>
      <% else %>
        <%= image_tag "back.jpeg", class: "anime_image" %>
      <% end %>
 
</div>


           <div class="na">
                  <nav class="navbar navbar-expand-lg " >
  <div class="container-fluid cf">
     <div class="nav-logo">
              <h3>Anime B</h3>
            </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav nn"  >
        
          <%= render "shared/application_nav" %>

        <li class="nav-item">
 <div class="auth-links" style="padding-top: 5px;">
              <%= login_helper %>
            </div>
        </li>
        <li class="nav-item" style=" align-self:center; padding-top: 5px;">
           <div class="profile-avatar" style="padding-left: 5px;">
              <%=link_to  profile_path(current_user.slug) , class:"prav-link"  do%>
              <%=profile_avatar(current_user.profile_picture)  %>
              <%end%>
            </div>
        </li>
      </ul>
    </div>
  </div>

</nav>
 <hr></hr>  
          </div>
        
       
        <% if !current_user.is_a?(GuestUser) %>
      <div class="nav-index1">
       <div class="header-upload">
  <%= form_with model: current_user,
                url: update_header_path(current_user.slug),
                method: :patch,
                html: { multipart: true },
                data: { turbo: false } do |f| %>

    <!-- Icon -->
    <label for="header_icon_input" class="upload-icon">
      
      <%=content_tag(:i,"", class:"fa fa-camera")%>
    </label>

    <!-- Hidden file input -->
    <%= f.file_field :header_image,
          id: "header_icon_input",
          hidden: true,
          onchange: "this.form.submit()" %>
  <% end %>
</div>

    <div class="profile-collection">
       <ul class="tab-header" style="padding-top: 30px;">
    <li class="active"><%=content_tag(:i,"",class:"fa-regular fa-folder")%> Collections <%=@collection_count%></li>
  </ul>
  <div class="featured-collection">
    <h5 >Featured Collections</h5>
    <div class="create-new">
      <%= content_tag(:i, " Create New", class:"fa fa-plus new-btn") %>
    </div>
  </div>
     
 <div class="collections" style="min-height: 310px;">     
        
         <% if @collection_animes.present?%>
          <div class="collection-profile">
            <%@collection_animes.each do |collection| %>
     
<div class="collection-card" style="margin-bottom: 70px;">
   <%= button_to delete_collection_path(collection.id),
              method: :delete,
              class: "delete-btn" do %>

  <%=content_tag(:i, "", class:"fa-solid fa-trash")%>
      <%end%>
  <h3><%=collection.name%></h3>
  <div class="cards-container">
 <%collection.animes.each_with_index do |collection_anime, index|%>
     <div class="stacked-card <%= %w[card-left card-center card-right][index %3] %>">
      <img src="<%= collection_anime.thumb_image %>" alt="<%= collection_anime.title %>">
     </div>
 <%end %>
  </div>
</div>

            <%end %>
          </div>
          <%else %>
          <div class="no-collections">
<h4>No collections found</h4>
          </div>
<% end%>
 </div>

    </div>
</div>
 <%else%>
 <div class="not-logged">
  <p>Login to see your details</p>
 </div>
 <% end%>
      </div>
    </div>