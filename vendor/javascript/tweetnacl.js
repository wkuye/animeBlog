import r from"crypto";var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e={};(function(e){var gf=function(r){var t,e=new Float64Array(16);if(r)for(t=0;t<r.length;t++)e[t]=r[t];return e};var randombytes=function(){throw new Error("no PRNG")};var o=new Uint8Array(16);var n=new Uint8Array(32);n[0]=9;var a=gf(),i=gf([1]),s=gf([56129,1]),h=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(r,t,e,o){r[t]=e>>24&255;r[t+1]=e>>16&255;r[t+2]=e>>8&255;r[t+3]=255&e;r[t+4]=o>>24&255;r[t+5]=o>>16&255;r[t+6]=o>>8&255;r[t+7]=255&o}function vn(r,t,e,o,n){var a,i=0;for(a=0;a<n;a++)i|=r[t+a]^e[o+a];return(1&i-1>>>8)-1}function crypto_verify_16(r,t,e,o){return vn(r,t,e,o,16)}function crypto_verify_32(r,t,e,o){return vn(r,t,e,o,32)}function core_salsa20(r,t,e,o){var n=255&o[0]|(255&o[1])<<8|(255&o[2])<<16|(255&o[3])<<24,a=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,i=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,s=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,h=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,c=255&o[4]|(255&o[5])<<8|(255&o[6])<<16|(255&o[7])<<24,f=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,y=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,l=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,u=255&o[8]|(255&o[9])<<8|(255&o[10])<<16|(255&o[11])<<24,_=255&e[16]|(255&e[17])<<8|(255&e[18])<<16|(255&e[19])<<24,v=255&e[20]|(255&e[21])<<8|(255&e[22])<<16|(255&e[23])<<24,b=255&e[24]|(255&e[25])<<8|(255&e[26])<<16|(255&e[27])<<24,w=255&e[28]|(255&e[29])<<8|(255&e[30])<<16|(255&e[31])<<24,g=255&o[12]|(255&o[13])<<8|(255&o[14])<<16|(255&o[15])<<24;var d=n,x=a,m=i,k=s,U=h,E=c,T=f,B=y,L=p,K=l,Y=u,z=_,R=v,P=b,O=w,N=g,C;for(var F=0;F<20;F+=2){C=d+R|0;U^=C<<7|C>>>32-7;C=U+d|0;L^=C<<9|C>>>32-9;C=L+U|0;R^=C<<13|C>>>32-13;C=R+L|0;d^=C<<18|C>>>32-18;C=E+x|0;K^=C<<7|C>>>32-7;C=K+E|0;P^=C<<9|C>>>32-9;C=P+K|0;x^=C<<13|C>>>32-13;C=x+P|0;E^=C<<18|C>>>32-18;C=Y+T|0;O^=C<<7|C>>>32-7;C=O+Y|0;m^=C<<9|C>>>32-9;C=m+O|0;T^=C<<13|C>>>32-13;C=T+m|0;Y^=C<<18|C>>>32-18;C=N+z|0;k^=C<<7|C>>>32-7;C=k+N|0;B^=C<<9|C>>>32-9;C=B+k|0;z^=C<<13|C>>>32-13;C=z+B|0;N^=C<<18|C>>>32-18;C=d+k|0;x^=C<<7|C>>>32-7;C=x+d|0;m^=C<<9|C>>>32-9;C=m+x|0;k^=C<<13|C>>>32-13;C=k+m|0;d^=C<<18|C>>>32-18;C=E+U|0;T^=C<<7|C>>>32-7;C=T+E|0;B^=C<<9|C>>>32-9;C=B+T|0;U^=C<<13|C>>>32-13;C=U+B|0;E^=C<<18|C>>>32-18;C=Y+K|0;z^=C<<7|C>>>32-7;C=z+Y|0;L^=C<<9|C>>>32-9;C=L+z|0;K^=C<<13|C>>>32-13;C=K+L|0;Y^=C<<18|C>>>32-18;C=N+O|0;R^=C<<7|C>>>32-7;C=R+N|0;P^=C<<9|C>>>32-9;C=P+R|0;O^=C<<13|C>>>32-13;C=O+P|0;N^=C<<18|C>>>32-18}d=d+n|0;x=x+a|0;m=m+i|0;k=k+s|0;U=U+h|0;E=E+c|0;T=T+f|0;B=B+y|0;L=L+p|0;K=K+l|0;Y=Y+u|0;z=z+_|0;R=R+v|0;P=P+b|0;O=O+w|0;N=N+g|0;r[0]=d>>>0&255;r[1]=d>>>8&255;r[2]=d>>>16&255;r[3]=d>>>24&255;r[4]=x>>>0&255;r[5]=x>>>8&255;r[6]=x>>>16&255;r[7]=x>>>24&255;r[8]=m>>>0&255;r[9]=m>>>8&255;r[10]=m>>>16&255;r[11]=m>>>24&255;r[12]=k>>>0&255;r[13]=k>>>8&255;r[14]=k>>>16&255;r[15]=k>>>24&255;r[16]=U>>>0&255;r[17]=U>>>8&255;r[18]=U>>>16&255;r[19]=U>>>24&255;r[20]=E>>>0&255;r[21]=E>>>8&255;r[22]=E>>>16&255;r[23]=E>>>24&255;r[24]=T>>>0&255;r[25]=T>>>8&255;r[26]=T>>>16&255;r[27]=T>>>24&255;r[28]=B>>>0&255;r[29]=B>>>8&255;r[30]=B>>>16&255;r[31]=B>>>24&255;r[32]=L>>>0&255;r[33]=L>>>8&255;r[34]=L>>>16&255;r[35]=L>>>24&255;r[36]=K>>>0&255;r[37]=K>>>8&255;r[38]=K>>>16&255;r[39]=K>>>24&255;r[40]=Y>>>0&255;r[41]=Y>>>8&255;r[42]=Y>>>16&255;r[43]=Y>>>24&255;r[44]=z>>>0&255;r[45]=z>>>8&255;r[46]=z>>>16&255;r[47]=z>>>24&255;r[48]=R>>>0&255;r[49]=R>>>8&255;r[50]=R>>>16&255;r[51]=R>>>24&255;r[52]=P>>>0&255;r[53]=P>>>8&255;r[54]=P>>>16&255;r[55]=P>>>24&255;r[56]=O>>>0&255;r[57]=O>>>8&255;r[58]=O>>>16&255;r[59]=O>>>24&255;r[60]=N>>>0&255;r[61]=N>>>8&255;r[62]=N>>>16&255;r[63]=N>>>24&255}function core_hsalsa20(r,t,e,o){var n=255&o[0]|(255&o[1])<<8|(255&o[2])<<16|(255&o[3])<<24,a=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,i=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,s=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,h=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,c=255&o[4]|(255&o[5])<<8|(255&o[6])<<16|(255&o[7])<<24,f=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,y=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,l=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,u=255&o[8]|(255&o[9])<<8|(255&o[10])<<16|(255&o[11])<<24,_=255&e[16]|(255&e[17])<<8|(255&e[18])<<16|(255&e[19])<<24,v=255&e[20]|(255&e[21])<<8|(255&e[22])<<16|(255&e[23])<<24,b=255&e[24]|(255&e[25])<<8|(255&e[26])<<16|(255&e[27])<<24,w=255&e[28]|(255&e[29])<<8|(255&e[30])<<16|(255&e[31])<<24,g=255&o[12]|(255&o[13])<<8|(255&o[14])<<16|(255&o[15])<<24;var d=n,x=a,m=i,k=s,U=h,E=c,T=f,B=y,L=p,K=l,Y=u,z=_,R=v,P=b,O=w,N=g,C;for(var F=0;F<20;F+=2){C=d+R|0;U^=C<<7|C>>>32-7;C=U+d|0;L^=C<<9|C>>>32-9;C=L+U|0;R^=C<<13|C>>>32-13;C=R+L|0;d^=C<<18|C>>>32-18;C=E+x|0;K^=C<<7|C>>>32-7;C=K+E|0;P^=C<<9|C>>>32-9;C=P+K|0;x^=C<<13|C>>>32-13;C=x+P|0;E^=C<<18|C>>>32-18;C=Y+T|0;O^=C<<7|C>>>32-7;C=O+Y|0;m^=C<<9|C>>>32-9;C=m+O|0;T^=C<<13|C>>>32-13;C=T+m|0;Y^=C<<18|C>>>32-18;C=N+z|0;k^=C<<7|C>>>32-7;C=k+N|0;B^=C<<9|C>>>32-9;C=B+k|0;z^=C<<13|C>>>32-13;C=z+B|0;N^=C<<18|C>>>32-18;C=d+k|0;x^=C<<7|C>>>32-7;C=x+d|0;m^=C<<9|C>>>32-9;C=m+x|0;k^=C<<13|C>>>32-13;C=k+m|0;d^=C<<18|C>>>32-18;C=E+U|0;T^=C<<7|C>>>32-7;C=T+E|0;B^=C<<9|C>>>32-9;C=B+T|0;U^=C<<13|C>>>32-13;C=U+B|0;E^=C<<18|C>>>32-18;C=Y+K|0;z^=C<<7|C>>>32-7;C=z+Y|0;L^=C<<9|C>>>32-9;C=L+z|0;K^=C<<13|C>>>32-13;C=K+L|0;Y^=C<<18|C>>>32-18;C=N+O|0;R^=C<<7|C>>>32-7;C=R+N|0;P^=C<<9|C>>>32-9;C=P+R|0;O^=C<<13|C>>>32-13;C=O+P|0;N^=C<<18|C>>>32-18}r[0]=d>>>0&255;r[1]=d>>>8&255;r[2]=d>>>16&255;r[3]=d>>>24&255;r[4]=E>>>0&255;r[5]=E>>>8&255;r[6]=E>>>16&255;r[7]=E>>>24&255;r[8]=Y>>>0&255;r[9]=Y>>>8&255;r[10]=Y>>>16&255;r[11]=Y>>>24&255;r[12]=N>>>0&255;r[13]=N>>>8&255;r[14]=N>>>16&255;r[15]=N>>>24&255;r[16]=T>>>0&255;r[17]=T>>>8&255;r[18]=T>>>16&255;r[19]=T>>>24&255;r[20]=B>>>0&255;r[21]=B>>>8&255;r[22]=B>>>16&255;r[23]=B>>>24&255;r[24]=L>>>0&255;r[25]=L>>>8&255;r[26]=L>>>16&255;r[27]=L>>>24&255;r[28]=K>>>0&255;r[29]=K>>>8&255;r[30]=K>>>16&255;r[31]=K>>>24&255}function crypto_core_salsa20(r,t,e,o){core_salsa20(r,t,e,o)}function crypto_core_hsalsa20(r,t,e,o){core_hsalsa20(r,t,e,o)}var l=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(r,t,e,o,n,a,i){var s=new Uint8Array(16),h=new Uint8Array(64);var c,f;for(f=0;f<16;f++)s[f]=0;for(f=0;f<8;f++)s[f]=a[f];while(n>=64){crypto_core_salsa20(h,s,i,l);for(f=0;f<64;f++)r[t+f]=e[o+f]^h[f];c=1;for(f=8;f<16;f++){c=c+(255&s[f])|0;s[f]=255&c;c>>>=8}n-=64;t+=64;o+=64}if(n>0){crypto_core_salsa20(h,s,i,l);for(f=0;f<n;f++)r[t+f]=e[o+f]^h[f]}return 0}function crypto_stream_salsa20(r,t,e,o,n){var a=new Uint8Array(16),i=new Uint8Array(64);var s,h;for(h=0;h<16;h++)a[h]=0;for(h=0;h<8;h++)a[h]=o[h];while(e>=64){crypto_core_salsa20(i,a,n,l);for(h=0;h<64;h++)r[t+h]=i[h];s=1;for(h=8;h<16;h++){s=s+(255&a[h])|0;a[h]=255&s;s>>>=8}e-=64;t+=64}if(e>0){crypto_core_salsa20(i,a,n,l);for(h=0;h<e;h++)r[t+h]=i[h]}return 0}function crypto_stream(r,t,e,o,n){var a=new Uint8Array(32);crypto_core_hsalsa20(a,o,n,l);var i=new Uint8Array(8);for(var s=0;s<8;s++)i[s]=o[s+16];return crypto_stream_salsa20(r,t,e,i,a)}function crypto_stream_xor(r,t,e,o,n,a,i){var s=new Uint8Array(32);crypto_core_hsalsa20(s,a,i,l);var h=new Uint8Array(8);for(var c=0;c<8;c++)h[c]=a[c+16];return crypto_stream_salsa20_xor(r,t,e,o,n,h,s)}var poly1305=function(r){(this||t).buffer=new Uint8Array(16);(this||t).r=new Uint16Array(10);(this||t).h=new Uint16Array(10);(this||t).pad=new Uint16Array(8);(this||t).leftover=0;(this||t).fin=0;var e,o,n,a,i,s,h,c;e=255&r[0]|(255&r[1])<<8;(this||t).r[0]=8191&e;o=255&r[2]|(255&r[3])<<8;(this||t).r[1]=8191&(e>>>13|o<<3);n=255&r[4]|(255&r[5])<<8;(this||t).r[2]=7939&(o>>>10|n<<6);a=255&r[6]|(255&r[7])<<8;(this||t).r[3]=8191&(n>>>7|a<<9);i=255&r[8]|(255&r[9])<<8;(this||t).r[4]=255&(a>>>4|i<<12);(this||t).r[5]=i>>>1&8190;s=255&r[10]|(255&r[11])<<8;(this||t).r[6]=8191&(i>>>14|s<<2);h=255&r[12]|(255&r[13])<<8;(this||t).r[7]=8065&(s>>>11|h<<5);c=255&r[14]|(255&r[15])<<8;(this||t).r[8]=8191&(h>>>8|c<<8);(this||t).r[9]=c>>>5&127;(this||t).pad[0]=255&r[16]|(255&r[17])<<8;(this||t).pad[1]=255&r[18]|(255&r[19])<<8;(this||t).pad[2]=255&r[20]|(255&r[21])<<8;(this||t).pad[3]=255&r[22]|(255&r[23])<<8;(this||t).pad[4]=255&r[24]|(255&r[25])<<8;(this||t).pad[5]=255&r[26]|(255&r[27])<<8;(this||t).pad[6]=255&r[28]|(255&r[29])<<8;(this||t).pad[7]=255&r[30]|(255&r[31])<<8};poly1305.prototype.blocks=function(r,e,o){var n=(this||t).fin?0:1<<11;var a,i,s,h,c,f,y,p,l;var u,_,v,b,w,g,d,x,m,k;var U=(this||t).h[0],E=(this||t).h[1],T=(this||t).h[2],B=(this||t).h[3],L=(this||t).h[4],K=(this||t).h[5],Y=(this||t).h[6],z=(this||t).h[7],R=(this||t).h[8],P=(this||t).h[9];var O=(this||t).r[0],N=(this||t).r[1],C=(this||t).r[2],F=(this||t).r[3],I=(this||t).r[4],G=(this||t).r[5],j=(this||t).r[6],q=(this||t).r[7],V=(this||t).r[8],X=(this||t).r[9];while(o>=16){a=255&r[e+0]|(255&r[e+1])<<8;U+=8191&a;i=255&r[e+2]|(255&r[e+3])<<8;E+=8191&(a>>>13|i<<3);s=255&r[e+4]|(255&r[e+5])<<8;T+=8191&(i>>>10|s<<6);h=255&r[e+6]|(255&r[e+7])<<8;B+=8191&(s>>>7|h<<9);c=255&r[e+8]|(255&r[e+9])<<8;L+=8191&(h>>>4|c<<12);K+=c>>>1&8191;f=255&r[e+10]|(255&r[e+11])<<8;Y+=8191&(c>>>14|f<<2);y=255&r[e+12]|(255&r[e+13])<<8;z+=8191&(f>>>11|y<<5);p=255&r[e+14]|(255&r[e+15])<<8;R+=8191&(y>>>8|p<<8);P+=p>>>5|n;l=0;u=l;u+=U*O;u+=E*(5*X);u+=T*(5*V);u+=B*(5*q);u+=L*(5*j);l=u>>>13;u&=8191;u+=K*(5*G);u+=Y*(5*I);u+=z*(5*F);u+=R*(5*C);u+=P*(5*N);l+=u>>>13;u&=8191;_=l;_+=U*N;_+=E*O;_+=T*(5*X);_+=B*(5*V);_+=L*(5*q);l=_>>>13;_&=8191;_+=K*(5*j);_+=Y*(5*G);_+=z*(5*I);_+=R*(5*F);_+=P*(5*C);l+=_>>>13;_&=8191;v=l;v+=U*C;v+=E*N;v+=T*O;v+=B*(5*X);v+=L*(5*V);l=v>>>13;v&=8191;v+=K*(5*q);v+=Y*(5*j);v+=z*(5*G);v+=R*(5*I);v+=P*(5*F);l+=v>>>13;v&=8191;b=l;b+=U*F;b+=E*C;b+=T*N;b+=B*O;b+=L*(5*X);l=b>>>13;b&=8191;b+=K*(5*V);b+=Y*(5*q);b+=z*(5*j);b+=R*(5*G);b+=P*(5*I);l+=b>>>13;b&=8191;w=l;w+=U*I;w+=E*F;w+=T*C;w+=B*N;w+=L*O;l=w>>>13;w&=8191;w+=K*(5*X);w+=Y*(5*V);w+=z*(5*q);w+=R*(5*j);w+=P*(5*G);l+=w>>>13;w&=8191;g=l;g+=U*G;g+=E*I;g+=T*F;g+=B*C;g+=L*N;l=g>>>13;g&=8191;g+=K*O;g+=Y*(5*X);g+=z*(5*V);g+=R*(5*q);g+=P*(5*j);l+=g>>>13;g&=8191;d=l;d+=U*j;d+=E*G;d+=T*I;d+=B*F;d+=L*C;l=d>>>13;d&=8191;d+=K*N;d+=Y*O;d+=z*(5*X);d+=R*(5*V);d+=P*(5*q);l+=d>>>13;d&=8191;x=l;x+=U*q;x+=E*j;x+=T*G;x+=B*I;x+=L*F;l=x>>>13;x&=8191;x+=K*C;x+=Y*N;x+=z*O;x+=R*(5*X);x+=P*(5*V);l+=x>>>13;x&=8191;m=l;m+=U*V;m+=E*q;m+=T*j;m+=B*G;m+=L*I;l=m>>>13;m&=8191;m+=K*F;m+=Y*C;m+=z*N;m+=R*O;m+=P*(5*X);l+=m>>>13;m&=8191;k=l;k+=U*X;k+=E*V;k+=T*q;k+=B*j;k+=L*G;l=k>>>13;k&=8191;k+=K*I;k+=Y*F;k+=z*C;k+=R*N;k+=P*O;l+=k>>>13;k&=8191;l=(l<<2)+l|0;l=l+u|0;u=8191&l;l>>>=13;_+=l;U=u;E=_;T=v;B=b;L=w;K=g;Y=d;z=x;R=m;P=k;e+=16;o-=16}(this||t).h[0]=U;(this||t).h[1]=E;(this||t).h[2]=T;(this||t).h[3]=B;(this||t).h[4]=L;(this||t).h[5]=K;(this||t).h[6]=Y;(this||t).h[7]=z;(this||t).h[8]=R;(this||t).h[9]=P};poly1305.prototype.finish=function(r,e){var o=new Uint16Array(10);var n,a,i,s;if((this||t).leftover){s=(this||t).leftover;(this||t).buffer[s++]=1;for(;s<16;s++)(this||t).buffer[s]=0;(this||t).fin=1;this.blocks((this||t).buffer,0,16)}n=(this||t).h[1]>>>13;(this||t).h[1]&=8191;for(s=2;s<10;s++){(this||t).h[s]+=n;n=(this||t).h[s]>>>13;(this||t).h[s]&=8191}(this||t).h[0]+=5*n;n=(this||t).h[0]>>>13;(this||t).h[0]&=8191;(this||t).h[1]+=n;n=(this||t).h[1]>>>13;(this||t).h[1]&=8191;(this||t).h[2]+=n;o[0]=(this||t).h[0]+5;n=o[0]>>>13;o[0]&=8191;for(s=1;s<10;s++){o[s]=(this||t).h[s]+n;n=o[s]>>>13;o[s]&=8191}o[9]-=1<<13;a=(1^n)-1;for(s=0;s<10;s++)o[s]&=a;a=~a;for(s=0;s<10;s++)(this||t).h[s]=(this||t).h[s]&a|o[s];(this||t).h[0]=65535&((this||t).h[0]|(this||t).h[1]<<13);(this||t).h[1]=65535&((this||t).h[1]>>>3|(this||t).h[2]<<10);(this||t).h[2]=65535&((this||t).h[2]>>>6|(this||t).h[3]<<7);(this||t).h[3]=65535&((this||t).h[3]>>>9|(this||t).h[4]<<4);(this||t).h[4]=65535&((this||t).h[4]>>>12|(this||t).h[5]<<1|(this||t).h[6]<<14);(this||t).h[5]=65535&((this||t).h[6]>>>2|(this||t).h[7]<<11);(this||t).h[6]=65535&((this||t).h[7]>>>5|(this||t).h[8]<<8);(this||t).h[7]=65535&((this||t).h[8]>>>8|(this||t).h[9]<<5);i=(this||t).h[0]+(this||t).pad[0];(this||t).h[0]=65535&i;for(s=1;s<8;s++){i=((this||t).h[s]+(this||t).pad[s]|0)+(i>>>16)|0;(this||t).h[s]=65535&i}r[e+0]=(this||t).h[0]>>>0&255;r[e+1]=(this||t).h[0]>>>8&255;r[e+2]=(this||t).h[1]>>>0&255;r[e+3]=(this||t).h[1]>>>8&255;r[e+4]=(this||t).h[2]>>>0&255;r[e+5]=(this||t).h[2]>>>8&255;r[e+6]=(this||t).h[3]>>>0&255;r[e+7]=(this||t).h[3]>>>8&255;r[e+8]=(this||t).h[4]>>>0&255;r[e+9]=(this||t).h[4]>>>8&255;r[e+10]=(this||t).h[5]>>>0&255;r[e+11]=(this||t).h[5]>>>8&255;r[e+12]=(this||t).h[6]>>>0&255;r[e+13]=(this||t).h[6]>>>8&255;r[e+14]=(this||t).h[7]>>>0&255;r[e+15]=(this||t).h[7]>>>8&255};poly1305.prototype.update=function(r,e,o){var n,a;if((this||t).leftover){a=16-(this||t).leftover;a>o&&(a=o);for(n=0;n<a;n++)(this||t).buffer[(this||t).leftover+n]=r[e+n];o-=a;e+=a;(this||t).leftover+=a;if((this||t).leftover<16)return;this.blocks((this||t).buffer,0,16);(this||t).leftover=0}if(o>=16){a=o-o%16;this.blocks(r,e,a);e+=a;o-=a}if(o){for(n=0;n<o;n++)(this||t).buffer[(this||t).leftover+n]=r[e+n];(this||t).leftover+=o}};function crypto_onetimeauth(r,t,e,o,n,a){var i=new poly1305(a);i.update(e,o,n);i.finish(r,t);return 0}function crypto_onetimeauth_verify(r,t,e,o,n,a){var i=new Uint8Array(16);crypto_onetimeauth(i,0,e,o,n,a);return crypto_verify_16(r,t,i,0)}function crypto_secretbox(r,t,e,o,n){var a;if(e<32)return-1;crypto_stream_xor(r,0,t,0,e,o,n);crypto_onetimeauth(r,16,r,32,e-32,r);for(a=0;a<16;a++)r[a]=0;return 0}function crypto_secretbox_open(r,t,e,o,n){var a;var i=new Uint8Array(32);if(e<32)return-1;crypto_stream(i,0,32,o,n);if(0!==crypto_onetimeauth_verify(t,16,t,32,e-32,i))return-1;crypto_stream_xor(r,0,t,0,e,o,n);for(a=0;a<32;a++)r[a]=0;return 0}function set25519(r,t){var e;for(e=0;e<16;e++)r[e]=0|t[e]}function car25519(r){var t,e,o=1;for(t=0;t<16;t++){e=r[t]+o+65535;o=Math.floor(e/65536);r[t]=e-65536*o}r[0]+=o-1+37*(o-1)}function sel25519(r,t,e){var o,n=~(e-1);for(var a=0;a<16;a++){o=n&(r[a]^t[a]);r[a]^=o;t[a]^=o}}function pack25519(r,t){var e,o,n;var a=gf(),i=gf();for(e=0;e<16;e++)i[e]=t[e];car25519(i);car25519(i);car25519(i);for(o=0;o<2;o++){a[0]=i[0]-65517;for(e=1;e<15;e++){a[e]=i[e]-65535-(a[e-1]>>16&1);a[e-1]&=65535}a[15]=i[15]-32767-(a[14]>>16&1);n=a[15]>>16&1;a[14]&=65535;sel25519(i,a,1-n)}for(e=0;e<16;e++){r[2*e]=255&i[e];r[2*e+1]=i[e]>>8}}function neq25519(r,t){var e=new Uint8Array(32),o=new Uint8Array(32);pack25519(e,r);pack25519(o,t);return crypto_verify_32(e,0,o,0)}function par25519(r){var t=new Uint8Array(32);pack25519(t,r);return 1&t[0]}function unpack25519(r,t){var e;for(e=0;e<16;e++)r[e]=t[2*e]+(t[2*e+1]<<8);r[15]&=32767}function A(r,t,e){for(var o=0;o<16;o++)r[o]=t[o]+e[o]}function Z(r,t,e){for(var o=0;o<16;o++)r[o]=t[o]-e[o]}function M(r,t,e){var o,n,a=0,i=0,s=0,h=0,c=0,f=0,y=0,p=0,l=0,u=0,_=0,v=0,b=0,w=0,g=0,d=0,x=0,m=0,k=0,U=0,E=0,T=0,B=0,L=0,K=0,Y=0,z=0,R=0,P=0,O=0,N=0,C=e[0],F=e[1],I=e[2],G=e[3],j=e[4],q=e[5],V=e[6],X=e[7],D=e[8],H=e[9],J=e[10],Q=e[11],W=e[12],$=e[13],rr=e[14],tr=e[15];o=t[0];a+=o*C;i+=o*F;s+=o*I;h+=o*G;c+=o*j;f+=o*q;y+=o*V;p+=o*X;l+=o*D;u+=o*H;_+=o*J;v+=o*Q;b+=o*W;w+=o*$;g+=o*rr;d+=o*tr;o=t[1];i+=o*C;s+=o*F;h+=o*I;c+=o*G;f+=o*j;y+=o*q;p+=o*V;l+=o*X;u+=o*D;_+=o*H;v+=o*J;b+=o*Q;w+=o*W;g+=o*$;d+=o*rr;x+=o*tr;o=t[2];s+=o*C;h+=o*F;c+=o*I;f+=o*G;y+=o*j;p+=o*q;l+=o*V;u+=o*X;_+=o*D;v+=o*H;b+=o*J;w+=o*Q;g+=o*W;d+=o*$;x+=o*rr;m+=o*tr;o=t[3];h+=o*C;c+=o*F;f+=o*I;y+=o*G;p+=o*j;l+=o*q;u+=o*V;_+=o*X;v+=o*D;b+=o*H;w+=o*J;g+=o*Q;d+=o*W;x+=o*$;m+=o*rr;k+=o*tr;o=t[4];c+=o*C;f+=o*F;y+=o*I;p+=o*G;l+=o*j;u+=o*q;_+=o*V;v+=o*X;b+=o*D;w+=o*H;g+=o*J;d+=o*Q;x+=o*W;m+=o*$;k+=o*rr;U+=o*tr;o=t[5];f+=o*C;y+=o*F;p+=o*I;l+=o*G;u+=o*j;_+=o*q;v+=o*V;b+=o*X;w+=o*D;g+=o*H;d+=o*J;x+=o*Q;m+=o*W;k+=o*$;U+=o*rr;E+=o*tr;o=t[6];y+=o*C;p+=o*F;l+=o*I;u+=o*G;_+=o*j;v+=o*q;b+=o*V;w+=o*X;g+=o*D;d+=o*H;x+=o*J;m+=o*Q;k+=o*W;U+=o*$;E+=o*rr;T+=o*tr;o=t[7];p+=o*C;l+=o*F;u+=o*I;_+=o*G;v+=o*j;b+=o*q;w+=o*V;g+=o*X;d+=o*D;x+=o*H;m+=o*J;k+=o*Q;U+=o*W;E+=o*$;T+=o*rr;B+=o*tr;o=t[8];l+=o*C;u+=o*F;_+=o*I;v+=o*G;b+=o*j;w+=o*q;g+=o*V;d+=o*X;x+=o*D;m+=o*H;k+=o*J;U+=o*Q;E+=o*W;T+=o*$;B+=o*rr;L+=o*tr;o=t[9];u+=o*C;_+=o*F;v+=o*I;b+=o*G;w+=o*j;g+=o*q;d+=o*V;x+=o*X;m+=o*D;k+=o*H;U+=o*J;E+=o*Q;T+=o*W;B+=o*$;L+=o*rr;K+=o*tr;o=t[10];_+=o*C;v+=o*F;b+=o*I;w+=o*G;g+=o*j;d+=o*q;x+=o*V;m+=o*X;k+=o*D;U+=o*H;E+=o*J;T+=o*Q;B+=o*W;L+=o*$;K+=o*rr;Y+=o*tr;o=t[11];v+=o*C;b+=o*F;w+=o*I;g+=o*G;d+=o*j;x+=o*q;m+=o*V;k+=o*X;U+=o*D;E+=o*H;T+=o*J;B+=o*Q;L+=o*W;K+=o*$;Y+=o*rr;z+=o*tr;o=t[12];b+=o*C;w+=o*F;g+=o*I;d+=o*G;x+=o*j;m+=o*q;k+=o*V;U+=o*X;E+=o*D;T+=o*H;B+=o*J;L+=o*Q;K+=o*W;Y+=o*$;z+=o*rr;R+=o*tr;o=t[13];w+=o*C;g+=o*F;d+=o*I;x+=o*G;m+=o*j;k+=o*q;U+=o*V;E+=o*X;T+=o*D;B+=o*H;L+=o*J;K+=o*Q;Y+=o*W;z+=o*$;R+=o*rr;P+=o*tr;o=t[14];g+=o*C;d+=o*F;x+=o*I;m+=o*G;k+=o*j;U+=o*q;E+=o*V;T+=o*X;B+=o*D;L+=o*H;K+=o*J;Y+=o*Q;z+=o*W;R+=o*$;P+=o*rr;O+=o*tr;o=t[15];d+=o*C;x+=o*F;m+=o*I;k+=o*G;U+=o*j;E+=o*q;T+=o*V;B+=o*X;L+=o*D;K+=o*H;Y+=o*J;z+=o*Q;R+=o*W;P+=o*$;O+=o*rr;N+=o*tr;a+=38*x;i+=38*m;s+=38*k;h+=38*U;c+=38*E;f+=38*T;y+=38*B;p+=38*L;l+=38*K;u+=38*Y;_+=38*z;v+=38*R;b+=38*P;w+=38*O;g+=38*N;n=1;o=a+n+65535;n=Math.floor(o/65536);a=o-65536*n;o=i+n+65535;n=Math.floor(o/65536);i=o-65536*n;o=s+n+65535;n=Math.floor(o/65536);s=o-65536*n;o=h+n+65535;n=Math.floor(o/65536);h=o-65536*n;o=c+n+65535;n=Math.floor(o/65536);c=o-65536*n;o=f+n+65535;n=Math.floor(o/65536);f=o-65536*n;o=y+n+65535;n=Math.floor(o/65536);y=o-65536*n;o=p+n+65535;n=Math.floor(o/65536);p=o-65536*n;o=l+n+65535;n=Math.floor(o/65536);l=o-65536*n;o=u+n+65535;n=Math.floor(o/65536);u=o-65536*n;o=_+n+65535;n=Math.floor(o/65536);_=o-65536*n;o=v+n+65535;n=Math.floor(o/65536);v=o-65536*n;o=b+n+65535;n=Math.floor(o/65536);b=o-65536*n;o=w+n+65535;n=Math.floor(o/65536);w=o-65536*n;o=g+n+65535;n=Math.floor(o/65536);g=o-65536*n;o=d+n+65535;n=Math.floor(o/65536);d=o-65536*n;a+=n-1+37*(n-1);n=1;o=a+n+65535;n=Math.floor(o/65536);a=o-65536*n;o=i+n+65535;n=Math.floor(o/65536);i=o-65536*n;o=s+n+65535;n=Math.floor(o/65536);s=o-65536*n;o=h+n+65535;n=Math.floor(o/65536);h=o-65536*n;o=c+n+65535;n=Math.floor(o/65536);c=o-65536*n;o=f+n+65535;n=Math.floor(o/65536);f=o-65536*n;o=y+n+65535;n=Math.floor(o/65536);y=o-65536*n;o=p+n+65535;n=Math.floor(o/65536);p=o-65536*n;o=l+n+65535;n=Math.floor(o/65536);l=o-65536*n;o=u+n+65535;n=Math.floor(o/65536);u=o-65536*n;o=_+n+65535;n=Math.floor(o/65536);_=o-65536*n;o=v+n+65535;n=Math.floor(o/65536);v=o-65536*n;o=b+n+65535;n=Math.floor(o/65536);b=o-65536*n;o=w+n+65535;n=Math.floor(o/65536);w=o-65536*n;o=g+n+65535;n=Math.floor(o/65536);g=o-65536*n;o=d+n+65535;n=Math.floor(o/65536);d=o-65536*n;a+=n-1+37*(n-1);r[0]=a;r[1]=i;r[2]=s;r[3]=h;r[4]=c;r[5]=f;r[6]=y;r[7]=p;r[8]=l;r[9]=u;r[10]=_;r[11]=v;r[12]=b;r[13]=w;r[14]=g;r[15]=d}function S(r,t){M(r,t,t)}function inv25519(r,t){var e=gf();var o;for(o=0;o<16;o++)e[o]=t[o];for(o=253;o>=0;o--){S(e,e);2!==o&&4!==o&&M(e,e,t)}for(o=0;o<16;o++)r[o]=e[o]}function pow2523(r,t){var e=gf();var o;for(o=0;o<16;o++)e[o]=t[o];for(o=250;o>=0;o--){S(e,e);1!==o&&M(e,e,t)}for(o=0;o<16;o++)r[o]=e[o]}function crypto_scalarmult(r,t,e){var o=new Uint8Array(32);var n=new Float64Array(80),a,i;var h=gf(),c=gf(),f=gf(),y=gf(),p=gf(),l=gf();for(i=0;i<31;i++)o[i]=t[i];o[31]=127&t[31]|64;o[0]&=248;unpack25519(n,e);for(i=0;i<16;i++){c[i]=n[i];y[i]=h[i]=f[i]=0}h[0]=y[0]=1;for(i=254;i>=0;--i){a=o[i>>>3]>>>(7&i)&1;sel25519(h,c,a);sel25519(f,y,a);A(p,h,f);Z(h,h,f);A(f,c,y);Z(c,c,y);S(y,p);S(l,h);M(h,f,h);M(f,c,p);A(p,h,f);Z(h,h,f);S(c,h);Z(f,y,l);M(h,f,s);A(h,h,y);M(f,f,h);M(h,y,l);M(y,c,n);S(c,p);sel25519(h,c,a);sel25519(f,y,a)}for(i=0;i<16;i++){n[i+16]=h[i];n[i+32]=f[i];n[i+48]=c[i];n[i+64]=y[i]}var u=n.subarray(32);var _=n.subarray(16);inv25519(u,u);M(_,_,u);pack25519(r,_);return 0}function crypto_scalarmult_base(r,t){return crypto_scalarmult(r,t,n)}function crypto_box_keypair(r,t){randombytes(t,32);return crypto_scalarmult_base(r,t)}function crypto_box_beforenm(r,t,e){var n=new Uint8Array(32);crypto_scalarmult(n,e,t);return crypto_core_hsalsa20(r,o,n,l)}var u=crypto_secretbox;var _=crypto_secretbox_open;function crypto_box(r,t,e,o,n,a){var i=new Uint8Array(32);crypto_box_beforenm(i,n,a);return u(r,t,e,o,i)}function crypto_box_open(r,t,e,o,n,a){var i=new Uint8Array(32);crypto_box_beforenm(i,n,a);return _(r,t,e,o,i)}var v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(r,t,e,o){var n=new Int32Array(16),a=new Int32Array(16),i,s,h,c,f,y,p,l,u,_,b,w,g,d,x,m,k,U,E,T,B,L,K,Y,z,R;var P=r[0],O=r[1],N=r[2],C=r[3],F=r[4],I=r[5],G=r[6],j=r[7],q=t[0],V=t[1],X=t[2],D=t[3],H=t[4],J=t[5],Q=t[6],W=t[7];var $=0;while(o>=128){for(E=0;E<16;E++){T=8*E+$;n[E]=e[T+0]<<24|e[T+1]<<16|e[T+2]<<8|e[T+3];a[E]=e[T+4]<<24|e[T+5]<<16|e[T+6]<<8|e[T+7]}for(E=0;E<80;E++){i=P;s=O;h=N;c=C;f=F;y=I;p=G;l=j;u=q;_=V;b=X;w=D;g=H;d=J;x=Q;m=W;B=j;L=W;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=(F>>>14|H<<32-14)^(F>>>18|H<<32-18)^(H>>>41-32|F<<32-(41-32));L=(H>>>14|F<<32-14)^(H>>>18|F<<32-18)^(F>>>41-32|H<<32-(41-32));K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;B=F&I^~F&G;L=H&J^~H&Q;K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;B=v[2*E];L=v[2*E+1];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;B=n[E%16];L=a[E%16];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;k=65535&z|R<<16;U=65535&K|Y<<16;B=k;L=U;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=(P>>>28|q<<32-28)^(q>>>34-32|P<<32-(34-32))^(q>>>39-32|P<<32-(39-32));L=(q>>>28|P<<32-28)^(P>>>34-32|q<<32-(34-32))^(P>>>39-32|q<<32-(39-32));K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;B=P&O^P&N^O&N;L=q&V^q&X^V&X;K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;l=65535&z|R<<16;m=65535&K|Y<<16;B=c;L=w;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=k;L=U;K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;c=65535&z|R<<16;w=65535&K|Y<<16;O=i;N=s;C=h;F=c;I=f;G=y;j=p;P=l;V=u;X=_;D=b;H=w;J=g;Q=d;W=x;q=m;if(E%16===15)for(T=0;T<16;T++){B=n[T];L=a[T];K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=n[(T+9)%16];L=a[(T+9)%16];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;k=n[(T+1)%16];U=a[(T+1)%16];B=(k>>>1|U<<32-1)^(k>>>8|U<<32-8)^k>>>7;L=(U>>>1|k<<32-1)^(U>>>8|k<<32-8)^(U>>>7|k<<32-7);K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;k=n[(T+14)%16];U=a[(T+14)%16];B=(k>>>19|U<<32-19)^(U>>>61-32|k<<32-(61-32))^k>>>6;L=(U>>>19|k<<32-19)^(k>>>61-32|U<<32-(61-32))^(U>>>6|k<<32-6);K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;n[T]=65535&z|R<<16;a[T]=65535&K|Y<<16}}B=P;L=q;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[0];L=t[0];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[0]=P=65535&z|R<<16;t[0]=q=65535&K|Y<<16;B=O;L=V;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[1];L=t[1];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[1]=O=65535&z|R<<16;t[1]=V=65535&K|Y<<16;B=N;L=X;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[2];L=t[2];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[2]=N=65535&z|R<<16;t[2]=X=65535&K|Y<<16;B=C;L=D;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[3];L=t[3];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[3]=C=65535&z|R<<16;t[3]=D=65535&K|Y<<16;B=F;L=H;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[4];L=t[4];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[4]=F=65535&z|R<<16;t[4]=H=65535&K|Y<<16;B=I;L=J;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[5];L=t[5];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[5]=I=65535&z|R<<16;t[5]=J=65535&K|Y<<16;B=G;L=Q;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[6];L=t[6];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[6]=G=65535&z|R<<16;t[6]=Q=65535&K|Y<<16;B=j;L=W;K=65535&L;Y=L>>>16;z=65535&B;R=B>>>16;B=r[7];L=t[7];K+=65535&L;Y+=L>>>16;z+=65535&B;R+=B>>>16;Y+=K>>>16;z+=Y>>>16;R+=z>>>16;r[7]=j=65535&z|R<<16;t[7]=W=65535&K|Y<<16;$+=128;o-=128}return o}function crypto_hash(r,t,e){var o=new Int32Array(8),n=new Int32Array(8),a=new Uint8Array(256),i,s=e;o[0]=1779033703;o[1]=3144134277;o[2]=1013904242;o[3]=2773480762;o[4]=1359893119;o[5]=2600822924;o[6]=528734635;o[7]=1541459225;n[0]=4089235720;n[1]=2227873595;n[2]=4271175723;n[3]=1595750129;n[4]=2917565137;n[5]=725511199;n[6]=4215389547;n[7]=327033209;crypto_hashblocks_hl(o,n,t,e);e%=128;for(i=0;i<e;i++)a[i]=t[s-e+i];a[e]=128;e=256-128*(e<112?1:0);a[e-9]=0;ts64(a,e-8,s/536870912|0,s<<3);crypto_hashblocks_hl(o,n,a,e);for(i=0;i<8;i++)ts64(r,8*i,o[i],n[i]);return 0}function add(r,t){var e=gf(),o=gf(),n=gf(),a=gf(),i=gf(),s=gf(),h=gf(),f=gf(),y=gf();Z(e,r[1],r[0]);Z(y,t[1],t[0]);M(e,e,y);A(o,r[0],r[1]);A(y,t[0],t[1]);M(o,o,y);M(n,r[3],t[3]);M(n,n,c);M(a,r[2],t[2]);A(a,a,a);Z(i,o,e);Z(s,a,n);A(h,a,n);A(f,o,e);M(r[0],i,s);M(r[1],f,h);M(r[2],h,s);M(r[3],i,f)}function cswap(r,t,e){var o;for(o=0;o<4;o++)sel25519(r[o],t[o],e)}function pack(r,t){var e=gf(),o=gf(),n=gf();inv25519(n,t[2]);M(e,t[0],n);M(o,t[1],n);pack25519(r,o);r[31]^=par25519(e)<<7}function scalarmult(r,t,e){var o,n;set25519(r[0],a);set25519(r[1],i);set25519(r[2],i);set25519(r[3],a);for(n=255;n>=0;--n){o=e[n/8|0]>>(7&n)&1;cswap(r,t,o);add(t,r);add(r,r);cswap(r,t,o)}}function scalarbase(r,t){var e=[gf(),gf(),gf(),gf()];set25519(e[0],f);set25519(e[1],y);set25519(e[2],i);M(e[3],f,y);scalarmult(r,e,t)}function crypto_sign_keypair(r,t,e){var o=new Uint8Array(64);var n=[gf(),gf(),gf(),gf()];var a;e||randombytes(t,32);crypto_hash(o,t,32);o[0]&=248;o[31]&=127;o[31]|=64;scalarbase(n,o);pack(r,n);for(a=0;a<32;a++)t[a+32]=r[a];return 0}var b=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(r,t){var e,o,n,a;for(o=63;o>=32;--o){e=0;for(n=o-32,a=o-12;n<a;++n){t[n]+=e-16*t[o]*b[n-(o-32)];e=t[n]+128>>8;t[n]-=256*e}t[n]+=e;t[o]=0}e=0;for(n=0;n<32;n++){t[n]+=e-(t[31]>>4)*b[n];e=t[n]>>8;t[n]&=255}for(n=0;n<32;n++)t[n]-=e*b[n];for(o=0;o<32;o++){t[o+1]+=t[o]>>8;r[o]=255&t[o]}}function reduce(r){var t=new Float64Array(64),e;for(e=0;e<64;e++)t[e]=r[e];for(e=0;e<64;e++)r[e]=0;modL(r,t)}function crypto_sign(r,t,e,o){var n=new Uint8Array(64),a=new Uint8Array(64),i=new Uint8Array(64);var s,h,c=new Float64Array(64);var f=[gf(),gf(),gf(),gf()];crypto_hash(n,o,32);n[0]&=248;n[31]&=127;n[31]|=64;var y=e+64;for(s=0;s<e;s++)r[64+s]=t[s];for(s=0;s<32;s++)r[32+s]=n[32+s];crypto_hash(i,r.subarray(32),e+32);reduce(i);scalarbase(f,i);pack(r,f);for(s=32;s<64;s++)r[s]=o[s];crypto_hash(a,r,e+64);reduce(a);for(s=0;s<64;s++)c[s]=0;for(s=0;s<32;s++)c[s]=i[s];for(s=0;s<32;s++)for(h=0;h<32;h++)c[s+h]+=a[s]*n[h];modL(r.subarray(32),c);return y}function unpackneg(r,t){var e=gf(),o=gf(),n=gf(),s=gf(),c=gf(),f=gf(),y=gf();set25519(r[2],i);unpack25519(r[1],t);S(n,r[1]);M(s,n,h);Z(n,n,r[2]);A(s,r[2],s);S(c,s);S(f,c);M(y,f,c);M(e,y,n);M(e,e,s);pow2523(e,e);M(e,e,n);M(e,e,s);M(e,e,s);M(r[0],e,s);S(o,r[0]);M(o,o,s);neq25519(o,n)&&M(r[0],r[0],p);S(o,r[0]);M(o,o,s);if(neq25519(o,n))return-1;par25519(r[0])===t[31]>>7&&Z(r[0],a,r[0]);M(r[3],r[0],r[1]);return 0}function crypto_sign_open(r,t,e,o){var n,a;var i=new Uint8Array(32),s=new Uint8Array(64);var h=[gf(),gf(),gf(),gf()],c=[gf(),gf(),gf(),gf()];a=-1;if(e<64)return-1;if(unpackneg(c,o))return-1;for(n=0;n<e;n++)r[n]=t[n];for(n=0;n<32;n++)r[n+32]=o[n];crypto_hash(s,r,e);reduce(s);scalarmult(h,c,s);scalarbase(c,t.subarray(32));add(h,c);pack(i,h);e-=64;if(crypto_verify_32(t,0,i,0)){for(n=0;n<e;n++)r[n]=0;return-1}for(n=0;n<e;n++)r[n]=t[n+64];a=e;return a}var w=32,g=24,d=32,x=16,m=32,k=32,U=32,E=32,T=32,B=g,L=d,K=x,Y=64,z=32,R=64,P=32,O=64;e.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:u,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:w,crypto_secretbox_NONCEBYTES:g,crypto_secretbox_ZEROBYTES:d,crypto_secretbox_BOXZEROBYTES:x,crypto_scalarmult_BYTES:m,crypto_scalarmult_SCALARBYTES:k,crypto_box_PUBLICKEYBYTES:U,crypto_box_SECRETKEYBYTES:E,crypto_box_BEFORENMBYTES:T,crypto_box_NONCEBYTES:B,crypto_box_ZEROBYTES:L,crypto_box_BOXZEROBYTES:K,crypto_sign_BYTES:Y,crypto_sign_PUBLICKEYBYTES:z,crypto_sign_SECRETKEYBYTES:R,crypto_sign_SEEDBYTES:P,crypto_hash_BYTES:O};function checkLengths(r,t){if(r.length!==w)throw new Error("bad key size");if(t.length!==g)throw new Error("bad nonce size")}function checkBoxLengths(r,t){if(r.length!==U)throw new Error("bad public key size");if(t.length!==E)throw new Error("bad secret key size")}function checkArrayTypes(){var r,t;for(t=0;t<arguments.length;t++)if("[object Uint8Array]"!==(r=Object.prototype.toString.call(arguments[t])))throw new TypeError("unexpected type "+r+", use Uint8Array")}function cleanup(r){for(var t=0;t<r.length;t++)r[t]=0}if(!e.util){e.util={};e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}}e.randomBytes=function(r){var t=new Uint8Array(r);randombytes(t,r);return t};e.secretbox=function(r,t,e){checkArrayTypes(r,t,e);checkLengths(e,t);var o=new Uint8Array(d+r.length);var n=new Uint8Array(o.length);for(var a=0;a<r.length;a++)o[a+d]=r[a];crypto_secretbox(n,o,o.length,t,e);return n.subarray(x)};e.secretbox.open=function(r,t,e){checkArrayTypes(r,t,e);checkLengths(e,t);var o=new Uint8Array(x+r.length);var n=new Uint8Array(o.length);for(var a=0;a<r.length;a++)o[a+x]=r[a];return!(o.length<32)&&(0===crypto_secretbox_open(n,o,o.length,t,e)&&n.subarray(d))};e.secretbox.keyLength=w;e.secretbox.nonceLength=g;e.secretbox.overheadLength=x;e.scalarMult=function(r,t){checkArrayTypes(r,t);if(r.length!==k)throw new Error("bad n size");if(t.length!==m)throw new Error("bad p size");var e=new Uint8Array(m);crypto_scalarmult(e,r,t);return e};e.scalarMult.base=function(r){checkArrayTypes(r);if(r.length!==k)throw new Error("bad n size");var t=new Uint8Array(m);crypto_scalarmult_base(t,r);return t};e.scalarMult.scalarLength=k;e.scalarMult.groupElementLength=m;e.box=function(r,t,o,n){var a=e.box.before(o,n);return e.secretbox(r,t,a)};e.box.before=function(r,t){checkArrayTypes(r,t);checkBoxLengths(r,t);var e=new Uint8Array(T);crypto_box_beforenm(e,r,t);return e};e.box.after=e.secretbox;e.box.open=function(r,t,o,n){var a=e.box.before(o,n);return e.secretbox.open(r,t,a)};e.box.open.after=e.secretbox.open;e.box.keyPair=function(){var r=new Uint8Array(U);var t=new Uint8Array(E);crypto_box_keypair(r,t);return{publicKey:r,secretKey:t}};e.box.keyPair.fromSecretKey=function(r){checkArrayTypes(r);if(r.length!==E)throw new Error("bad secret key size");var t=new Uint8Array(U);crypto_scalarmult_base(t,r);return{publicKey:t,secretKey:new Uint8Array(r)}};e.box.publicKeyLength=U;e.box.secretKeyLength=E;e.box.sharedKeyLength=T;e.box.nonceLength=B;e.box.overheadLength=e.secretbox.overheadLength;e.sign=function(r,t){checkArrayTypes(r,t);if(t.length!==R)throw new Error("bad secret key size");var e=new Uint8Array(Y+r.length);crypto_sign(e,r,r.length,t);return e};e.sign.open=function(r,t){if(2!==arguments.length)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");checkArrayTypes(r,t);if(t.length!==z)throw new Error("bad public key size");var e=new Uint8Array(r.length);var o=crypto_sign_open(e,r,r.length,t);if(o<0)return null;var n=new Uint8Array(o);for(var a=0;a<n.length;a++)n[a]=e[a];return n};e.sign.detached=function(r,t){var o=e.sign(r,t);var n=new Uint8Array(Y);for(var a=0;a<n.length;a++)n[a]=o[a];return n};e.sign.detached.verify=function(r,t,e){checkArrayTypes(r,t,e);if(t.length!==Y)throw new Error("bad signature size");if(e.length!==z)throw new Error("bad public key size");var o=new Uint8Array(Y+r.length);var n=new Uint8Array(Y+r.length);var a;for(a=0;a<Y;a++)o[a]=t[a];for(a=0;a<r.length;a++)o[a+Y]=r[a];return crypto_sign_open(n,o,o.length,e)>=0};e.sign.keyPair=function(){var r=new Uint8Array(z);var t=new Uint8Array(R);crypto_sign_keypair(r,t);return{publicKey:r,secretKey:t}};e.sign.keyPair.fromSecretKey=function(r){checkArrayTypes(r);if(r.length!==R)throw new Error("bad secret key size");var t=new Uint8Array(z);for(var e=0;e<t.length;e++)t[e]=r[32+e];return{publicKey:t,secretKey:new Uint8Array(r)}};e.sign.keyPair.fromSeed=function(r){checkArrayTypes(r);if(r.length!==P)throw new Error("bad seed size");var t=new Uint8Array(z);var e=new Uint8Array(R);for(var o=0;o<32;o++)e[o]=r[o];crypto_sign_keypair(t,e,true);return{publicKey:t,secretKey:e}};e.sign.publicKeyLength=z;e.sign.secretKeyLength=R;e.sign.seedLength=P;e.sign.signatureLength=Y;e.hash=function(r){checkArrayTypes(r);var t=new Uint8Array(O);crypto_hash(t,r,r.length);return t};e.hash.hashLength=O;e.verify=function(r,t){checkArrayTypes(r,t);return 0!==r.length&&0!==t.length&&(r.length===t.length&&0===vn(r,0,t,0,r.length))};e.setPRNG=function(r){randombytes=r};(function(){var t="undefined"!==typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var o=65536;e.setPRNG((function(r,e){var n,a=new Uint8Array(e);for(n=0;n<e;n+=o)t.getRandomValues(a.subarray(n,n+Math.min(e-n,o)));for(n=0;n<e;n++)r[n]=a[n];cleanup(a)}))}else{t=r;t&&t.randomBytes&&e.setPRNG((function(r,e){var o,n=t.randomBytes(e);for(o=0;o<e;o++)r[o]=n[o];cleanup(n)}))}})()})(e||(self.nacl=self.nacl||{}));export default e;

