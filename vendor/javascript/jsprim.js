import*as e from"assert-plus";import*as r from"util";import*as t from"extsprintf";import*as a from"verror";import*as i from"json-schema";var n="default"in e?e.default:e;"default"in r&&r.default;var o="default"in t?t.default:t;var s="default"in a?a.default:a;var l="default"in i?i.default:i;var f={};var u=n;var c=o;var p=s;var d=l;f.deepCopy=deepCopy;f.deepEqual=deepEqual;f.isEmpty=isEmpty;f.hasKey=hasKey;f.forEachKey=forEachKey;f.pluck=pluck;f.flattenObject=flattenObject;f.flattenIter=flattenIter;f.validateJsonObject=validateJsonObjectJS;f.validateJsonObjectJS=validateJsonObjectJS;f.randElt=randElt;f.extraProperties=extraProperties;f.mergeObjects=mergeObjects;f.startsWith=startsWith;f.endsWith=endsWith;f.parseInteger=parseInteger;f.iso8601=iso8601;f.rfc1123=rfc1123;f.parseDateTime=parseDateTime;f.hrtimediff=hrtimeDiff;f.hrtimeDiff=hrtimeDiff;f.hrtimeAccum=hrtimeAccum;f.hrtimeAdd=hrtimeAdd;f.hrtimeNanosec=hrtimeNanosec;f.hrtimeMicrosec=hrtimeMicrosec;f.hrtimeMillisec=hrtimeMillisec;function deepCopy(e){var r,t;var a="__deepCopy";if(e&&e[a])throw new Error("attempted deep copy of cyclic object");if(e&&e.constructor==Object){r={};e[a]=true;for(t in e)t!=a&&(r[t]=deepCopy(e[t]));delete e[a];return r}if(e&&e.constructor==Array){r=[];e[a]=true;for(t=0;t<e.length;t++)r.push(deepCopy(e[t]));delete e[a];return r}return e}function deepEqual(e,r){if(typeof e!=typeof r)return false;if(null===e||null===r||"object"!=typeof e)return e===r;if(e.constructor!=r.constructor)return false;var t;for(t in e){if(!r.hasOwnProperty(t))return false;if(!deepEqual(e[t],r[t]))return false}for(t in r)if(!e.hasOwnProperty(t))return false;return true}function isEmpty(e){var r;for(r in e)return false;return true}function hasKey(e,r){u.equal(typeof r,"string");return Object.prototype.hasOwnProperty.call(e,r)}function forEachKey(e,r){for(var t in e)hasKey(e,t)&&r(t,e[t])}function pluck(e,r){u.equal(typeof r,"string");return pluckv(e,r)}function pluckv(e,r){if(null!==e&&"object"===typeof e){if(e.hasOwnProperty(r))return e[r];var t=r.indexOf(".");if(-1!=t){var a=r.substr(0,t);if(e.hasOwnProperty(a))return pluckv(e[a],r.substr(t+1))}}}function flattenIter(e,r,t){doFlattenIter(e,r,[],t)}function doFlattenIter(e,r,t,a){var i;var n;if(0!==r){u.ok(null!==e);u.equal(typeof e,"object");u.equal(typeof r,"number");u.ok(r>=0);for(n in e){i=t.slice(0);i.push(n);doFlattenIter(e[n],r-1,i,a)}}else{i=t.slice(0);i.push(e);a(i)}}function flattenObject(e,r){if(0===r)return[e];u.ok(null!==e);u.equal(typeof e,"object");u.equal(typeof r,"number");u.ok(r>=0);var t=[];var a;for(a in e)flattenObject(e[a],r-1).forEach((function(e){t.push([a].concat(e))}));return t}function startsWith(e,r){return e.substr(0,r.length)==r}function endsWith(e,r){return e.substr(e.length-r.length,r.length)==r}function iso8601(e){"number"==typeof e&&(e=new Date(e));u.ok(e.constructor===Date);return c.sprintf("%4d-%02d-%02dT%02d:%02d:%02d.%03dZ",e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}var m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function rfc1123(e){return c.sprintf("%s, %02d %s %04d %02d:%02d:%02d GMT",h[e.getUTCDay()],e.getUTCDate(),m[e.getUTCMonth()],e.getUTCFullYear(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}function parseDateTime(e){var r=+e;return isNaN(r)?new Date(e):new Date(r)}var v=Number.MAX_SAFE_INTEGER||9007199254740991;var g=Number.MIN_SAFE_INTEGER||-9007199254740991;var b={base:10,allowSign:true,allowPrefix:false,allowTrailing:false,allowImprecise:false,trimWhitespace:false,leadingZeroIsOctal:false};var y=48;var O=57;var w=65;var j=66;var E=79;var T=84;var C=88;var I=90;var M=97;var k=98;var A=111;var S=116;var D=120;var J=122;var x=48;var N=55;var W=87;function parseInteger(e,r){u.string(e,"str");u.optionalObject(r,"options");var t=false;var a=b;if(r){t=hasKey(r,"base");a=mergeObjects(a,r);u.number(a.base,"options.base");u.ok(a.base>=2,"options.base >= 2");u.ok(a.base<=36,"options.base <= 36");u.bool(a.allowSign,"options.allowSign");u.bool(a.allowPrefix,"options.allowPrefix");u.bool(a.allowTrailing,"options.allowTrailing");u.bool(a.allowImprecise,"options.allowImprecise");u.bool(a.trimWhitespace,"options.trimWhitespace");u.bool(a.leadingZeroIsOctal,"options.leadingZeroIsOctal");a.leadingZeroIsOctal&&u.ok(!t,'"base" and "leadingZeroIsOctal" are mutually exclusive')}var i;var n=-1;var o=a.base;var s;var l=1;var f=0;var c=0;var p=e.length;if(a.trimWhitespace)while(c<p&&isSpace(e.charCodeAt(c)))++c;if(a.allowSign)if("-"===e[c]){c+=1;l=-1}else"+"===e[c]&&(c+=1);if("0"===e[c]){if(a.allowPrefix){n=prefixToBase(e.charCodeAt(c+1));if(-1!==n&&(!t||n===o)){o=n;c+=2}}-1===n&&a.leadingZeroIsOctal&&(o=8)}for(s=c;c<p;++c){i=translateDigit(e.charCodeAt(c));if(!(-1!==i&&i<o))break;f*=o;f+=i}if(s===c)return new Error("invalid number: "+JSON.stringify(e));if(a.trimWhitespace)while(c<p&&isSpace(e.charCodeAt(c)))++c;if(c<p&&!a.allowTrailing)return new Error("trailing characters after number: "+JSON.stringify(e.slice(c)));if(0===f)return 0;var d=f*l;return!a.allowImprecise&&(f>v||d<g)?new Error("number is outside of the supported range: "+JSON.stringify(e.slice(s,c))):d}function translateDigit(e){return e>=y&&e<=O?e-x:e>=w&&e<=I?e-N:e>=M&&e<=J?e-W:-1}function isSpace(e){return 32===e||e>=9&&e<=13||160===e||5760===e||6158===e||e>=8192&&e<=8202||8232===e||8233===e||8239===e||8287===e||12288===e||65279===e}function prefixToBase(e){return e===k||e===j?2:e===A||e===E?8:e===S||e===T?10:e===D||e===C?16:-1}function validateJsonObjectJS(e,r){var t=d.validate(r,e);if(0===t.errors.length)return null;var a=t.errors[0];var i=a.property;var n=a.message.toLowerCase();var o,s;if(-1!=(o=n.indexOf("the property "))&&-1!=(s=n.indexOf(" is not defined in the schema and the schema does not allow additional properties"))){o+="the property ".length;i=""===i?n.substr(o,s-o):i+"."+n.substr(o,s-o);n="unsupported property"}var l=new p.VError('property "%s": %s',i,n);l.jsv_details=a;return l}function randElt(e){u.ok(Array.isArray(e)&&e.length>0,"randElt argument must be a non-empty array");return e[Math.floor(Math.random()*e.length)]}function assertHrtime(e){u.ok(e[0]>=0&&e[1]>=0,"negative numbers not allowed in hrtimes");u.ok(e[1]<1e9,"nanoseconds column overflow")}function hrtimeDiff(e,r){assertHrtime(e);assertHrtime(r);u.ok(e[0]>r[0]||e[0]==r[0]&&e[1]>=r[1],"negative differences not allowed");var t=[e[0]-r[0],0];if(e[1]>=r[1])t[1]=e[1]-r[1];else{t[0]--;t[1]=1e9-(r[1]-e[1])}return t}function hrtimeNanosec(e){assertHrtime(e);return Math.floor(1e9*e[0]+e[1])}function hrtimeMicrosec(e){assertHrtime(e);return Math.floor(1e6*e[0]+e[1]/1e3)}function hrtimeMillisec(e){assertHrtime(e);return Math.floor(1e3*e[0]+e[1]/1e6)}function hrtimeAccum(e,r){assertHrtime(e);assertHrtime(r);e[1]+=r[1];if(e[1]>=1e9){e[0]++;e[1]-=1e9}e[0]+=r[0];return e}function hrtimeAdd(e,r){assertHrtime(e);var t=[e[0],e[1]];return hrtimeAccum(t,r)}function extraProperties(e,r){u.ok("object"===typeof e&&null!==e,"obj argument must be a non-null object");u.ok(Array.isArray(r),"allowed argument must be an array of strings");for(var t=0;t<r.length;t++)u.ok("string"===typeof r[t],"allowed argument must be an array of strings");return Object.keys(e).filter((function(e){return-1===r.indexOf(e)}))}function mergeObjects(e,r,t){var a,i;a={};if(t)for(i in t)a[i]=t[i];if(e)for(i in e)a[i]=e[i];if(r)for(i in r)a[i]=r[i];return a}const P=f.validateJsonObject,U=f.hrtimediff;const q=f.deepCopy,K=f.deepEqual,H=f.isEmpty,F=f.hasKey,Z=f.forEachKey,_=f.pluck,G=f.flattenObject,B=f.flattenIter,R=f.validateJsonObjectJS,Y=f.randElt,L=f.extraProperties,V=f.mergeObjects,X=f.startsWith,z=f.endsWith,Q=f.parseInteger,$=f.iso8601,ee=f.rfc1123,re=f.parseDateTime,te=f.hrtimeDiff,ae=f.hrtimeAccum,ie=f.hrtimeAdd,ne=f.hrtimeNanosec,oe=f.hrtimeMicrosec,se=f.hrtimeMillisec;export{q as deepCopy,K as deepEqual,f as default,z as endsWith,L as extraProperties,B as flattenIter,G as flattenObject,Z as forEachKey,F as hasKey,ae as hrtimeAccum,ie as hrtimeAdd,te as hrtimeDiff,oe as hrtimeMicrosec,se as hrtimeMillisec,ne as hrtimeNanosec,U as hrtimediff,H as isEmpty,$ as iso8601,V as mergeObjects,re as parseDateTime,Q as parseInteger,_ as pluck,Y as randElt,ee as rfc1123,X as startsWith,P as validateJsonObject,R as validateJsonObjectJS};

